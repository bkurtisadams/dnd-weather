{{!-- Weather dialog template --}} 
<form class="dnd-weather-dialog">
  <div class="dialog-content">
    {{#if loading}}
      <div class="weather-loading">
        <i class="fas fa-spinner fa-spin"></i> Loading...
      </div>
    {{/if}}

    {{#if error}}
      <div class="weather-error">
        <i class="fas fa-exclamation-circle"></i>
        <span>{{error}}</span>
      </div>
    {{/if}}

    <div class="weather-current {{#if loading}}loading{{/if}}">
      {{!-- Temperature Section --}}
      <div class="weather-row">
        <div class="weather-icon">
          <i class="fas fa-thermometer-half"></i>
        </div>
        <div class="weather-data">
          <h3>Temperature</h3>
          <p class="temperature">High: {{weather.temperature}}°F</p>
          <p class="temperature">Low: {{weather.temperatureLow}}°F</p>
          {{#if weather.windChill}}
            <p class="wind-chill">
              Feels like {{weather.windChill}}°F
            </p>
          {{/if}}
          <p class="conditions">{{weather.conditions}}</p>
        </div>
      </div>

      {{!-- Wind Section --}}
      <div class="weather-row">
        <div class="weather-icon">
          <i class="fas fa-wind"></i>
        </div>
        <div class="weather-data">
          <h3>Wind Conditions</h3>
          <p>{{weather.wind}} mph from the {{weather.windDirection}}</p>
          {{#if effects.wind.length}}
            <ul class="effects-list">
              {{#each effects.wind}}
                <li>{{this}}</li>
              {{/each}}
            </ul>
          {{/if}}
        </div>
      </div>

      {{!-- Precipitation Section --}}
      <div class="weather-row">
        <div class="weather-icon">
          <i class="fas fa-cloud-rain"></i>
        </div>
        <div class="weather-data">
          <h3>Precipitation</h3>
          <p>{{weather.precipitation}}</p>
          {{#if effects.precipitation.length}}
            <ul class="effects-list">
              {{#each effects.precipitation}}
                <li>{{this}}</li>
              {{/each}}
            </ul>
          {{/if}}
        </div>
      </div>

      {{!-- Moon Phase Section --}}
      <div class="weather-row">
        <div class="weather-icon">
          <i class="fas fa-moon"></i>
        </div>
        <div class="weather-data">
          <h3>Moon Phase</h3>
          <p>{{weather.moonPhase}}</p>
        </div>
      </div>

      {{!-- Special Effects Section --}}
      {{#if effects.special.length}}
        <div class="weather-row">
          <div class="weather-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="weather-data">
            <h3>Special Events</h3>
            <ul class="effects-list">
              {{#each effects.special}}
                <li>{{this}}</li>
              {{/each}}
            </ul>
          </div>
        </div>
      {{/if}}
    </div>

    {{#if lastUpdate}}
      <div class="last-update">
        Last updated: {{lastUpdate}}
      </div>
    {{/if}}

    <div class="weather-controls">
      <button type="button" class="generate-weather" {{#if loading}}disabled{{/if}}>
        <i class="fas fa-dice"></i> Generate New Weather
      </button>
      
      {{#if isGM}}
        <button type="button" class="update-weather" {{#if loading}}disabled{{/if}}>
          <i class="fas fa-sync"></i> Update Weather
        </button>
        <button type="button" class="settings" {{#if loading}}disabled{{/if}}>
          <i class="fas fa-cog"></i> Settings
        </button>
      {{/if}}

      <button type="button" class="refresh-weather" {{#if loading}}disabled{{/if}}>
        <i class="fas fa-redo"></i> Refresh
      </button>
    </div>
  </div>
</form>